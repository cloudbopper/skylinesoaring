{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}
{% load member_extras %}
{% block content %}



<div class="container mt-4">
  <h2 class="mb-3">Log Flight</h2>

  <form method="post" enctype="multipart/form-data" class="mb-4">
    {% csrf_token %}
    {{ form|crispy }}
    <button type="submit" class="btn btn-primary">Save Flight</button>
  </form>

  <hr>

  <h3 class="mb-3">Flights for {{ today }}</h3>
  {% if flight_logs %}
    <table class="table table-sm table-striped">
      <thead>
        <tr>
          <th>Glider</th>
          <th>Pilot</th>
          <th>Passenger</th>
          <th>Tow Pilot</th>
          <th>Takeoff</th>
          <th>Landing</th>
          <th>Duration</th>
          <th>Field</th>
        </tr>
      </thead>
      <tbody>
        {% for flight in flight_logs %}
        <tr>
          <td>{{ flight.glider }}</td>
          <td>{{ flight.pilot|full_display_name }}</td>
          <td>{{ flight.instructor|full_display_name }}</td>
          <td>{{ flight.passenger|default:"â€”" }}</td>
          <td>{{ flight.towpilot|full_display_name }}</td>
          <td>{{ flight.takeoff_time }}</td>
          <td>{{ flight.landing_time }}</td>
          <td>{{ flight.flight_time }}</td>
          <td>{{ flight.airfield.code }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No flights logged today yet.</p>
  {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>


  <script>
    document.addEventListener("DOMContentLoaded", function () {
      flatpickr("#id_flight_date", {
        dateFormat: "Y-m-d",
        allowInput: true,
        defaultDate: "today"
      });


      flatpickr("#id_takeoff_time", {
        enableTime: true,
        noCalendar: true,
        dateFormat: "H:i",
        time_24hr: true,
        allowInput: true,
      });
    
      flatpickr("#id_landing_time", {
        enableTime: true,
        noCalendar: true,
        dateFormat: "H:i",
        time_24hr: true,
        allowInput: true,
      });
    });
    </script>



{% endblock %}
