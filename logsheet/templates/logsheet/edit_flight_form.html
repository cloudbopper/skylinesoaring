<form method="post" id="edit-flight-form">
    {% csrf_token %}
    {{ form|crispy }}
    <button type="submit" class="btn btn-primary">Save Changes</button>
  </form>
  
  <script>
    document.getElementById("edit-flight-form").addEventListener("submit", function(e) {
      e.preventDefault();
      const form = e.target;
      const url = form.action || window.location.href;
      const data = new FormData(form);
  
      fetch(url, {
        method: "POST",
        headers: { "X-Requested-With": "XMLHttpRequest" },
        body: data
      })
      .then(response => {
        if (!response.ok) throw new Error("Failed to save");
        return response.json();
      })
      .then(data => {
        if (data.success) {
          location.reload();  // reload the page to refresh flight list
        }
      })
      .catch(error => {
        alert("Could not save the flight. Please try again.");
      });
    });
  </script>
